<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºŒç»´ç ç”Ÿæˆå™¨</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>

<body>
    <div id="app" style="width: 1200px; margin: 0 auto;">

        <h1>ğŸ‰äºŒç»´ç ç”Ÿæˆå™¨</h1>

        <el-tabs v-model="activeName" type="card" @tab-click="handleClick">
            <el-tab-pane label="æ–‡å­—" name="first">
                æ–‡å­—å†…å®¹ï¼š
                <el-input type="textarea" v-model="form.text"></el-input>
                <br>
                <br>
                <el-button @click="doConvert">ç”ŸæˆäºŒç»´ç </el-button>
            </el-tab-pane>
            <el-tab-pane label="ç½‘å€" name="second">
                è¯·è¾“å…¥ç½‘å€ï¼š
                <el-input placeholder="Please input" v-model="form.text">
                    <template slot="prepend">http://</template>
                </el-input>
                <br>
                <br>
                <el-button @click="doConvert2">ç”ŸæˆäºŒç»´ç </el-button>
            </el-tab-pane>
            <el-tab-pane label="å…¶ä»–" name="third">å…¶ä»–åŠŸèƒ½ç­‰å¾…å¼€å‘ä¸­...</el-tab-pane>
        </el-tabs>

        <canvas id="canvas"></canvas>

        <br>

        <a v-show="href!='#'" id="download" :href="href">
            <el-button>ä¸‹è½½</el-button>
        </a>

    </div>



    <script src="./qrcode.min.js"></script>
    <script src="./vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>


    <script>
        var qrcode = null

        new Vue({
            el: '#app',
            data() {
                return {
                    activeName: 'first',
                    path: 0,
                    form: {
                        text: ''
                    },
                    href: '#'
                }
            },
            methods: {
                handleClick(tab, event) {
                    // console.log(tab, event);
                    this.form.text = ''
                    document.getElementById('canvas').innerHTML = ''
                },
                convertMsg(msg) {
                    QRCode.toCanvas(document.getElementById('canvas'), msg, function (error) {
                        if (error) { return error }
                        return true;
                    })
                },

                downloadCanvas(link, canvasId, filename) {
                    this.href = document.getElementById(canvasId).toDataURL();
                    link.download = filename;
                },

                doConvert() {
                    var res = this.convertMsg(this.form.text);

                    this.downloadCanvas(document.getElementById('download'), 'canvas', 'äºŒç»´ç .png')

                    this.$notify({
                        title: 'æˆåŠŸ',
                        message: 'æˆåŠŸç”ŸæˆäºŒç»´ç ï¼',
                        type: 'success'
                    });
                },
                doConvert2() {
                    var res = this.convertMsg("http://" + this.form.text);
                    this.downloadCanvas(document.getElementById('download'), 'canvas', 'äºŒç»´ç .png')
                    this.$notify({
                        title: 'æˆåŠŸ',
                        message: 'æˆåŠŸç”ŸæˆäºŒç»´ç ï¼',
                        type: 'success'
                    });
                }
            }
        })



    </script>
</body>

</html>